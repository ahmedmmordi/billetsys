<!--
  Eclipse Public License - v 2.0

    THE ACCOMPANYING PROGRAM IS PROVIDED UNDER THE TERMS OF THIS ECLIPSE
    PUBLIC LICENSE ("AGREEMENT"). ANY USE, REPRODUCTION OR DISTRIBUTION
    OF THE PROGRAM CONSTITUTES RECIPIENT'S ACCEPTANCE OF THIS AGREEMENT.
-->

{#include layout}
{#content}
<h1>{ticket.name}</h1>
<table>
    <tbody>
    <tr>
        <th>Status</th>
        <td>{ticket.status}</td>
    </tr>
    <tr>
        <th>Company</th>
        <td>{ticket.company.name}</td>
    </tr>
    </tbody>
</table>

<h2>Messages</h2>
{#if messages.isEmpty}
<p>No messages yet.</p>
{/if}
{#for message in messages}
<div style="margin-bottom: 12px;">
    <div><strong>{messageLabels.get(message.id)}</strong></div>
    <div class="markdown-output">{message.body.markdown}</div>
    {#if !message.attachments.isEmpty}
    <div style="background: rgba(176, 0, 32, 0.06); padding: 6px 10px; margin-top: 6px; display: flex; gap: 12px;">
        {#for attachment in message.attachments}
        <span>
            <a href="/attachments/{attachment.id}" target="_blank" rel="noopener"
               style="color: #b00020; text-decoration: none; font-weight: 600;">{attachment.name}</a>
        </span>
        <span style="margin-left: auto; text-align: right; font-size: 12px; color: #5b5b5b;">
            {attachment.mimeType} - {attachment.sizeLabel}
        </span>
        {/for}
    </div>
    {/if}
</div>
{/for}

<div class="form-actions">
    <a class="action-button" href="/user/tickets/{ticket.id}/edit">Edit</a>
    <a class="secondary-button" href="/user">Back</a>
</div>
{/content}
{/include}
